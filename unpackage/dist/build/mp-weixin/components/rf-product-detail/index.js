(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/rf-product-detail/index"],{"0da6":function(t,e,n){},"4c5a":function(t,e,n){"use strict";n.r(e);var r=n("cd35"),o=n("5689");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("de18");var a,u=n("f0c5"),c=Object(u["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);e["default"]=c.exports},5689:function(t,e,n){"use strict";n.r(e);var r=n("cb94"),o=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=o.a},cb94:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=s(n("a34a")),o=s(n("9e6c")),i=n("72a0"),a=n("dc85"),u=n("6f0d"),c=n("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(s){return void n(s)}u.done?e(c):Promise.resolve(c).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){f(i,r,o,a,u,"next",t)}function u(t){f(i,r,o,a,u,"throw",t)}a(void 0)}))}}var m=function(){n.e("components/rf-item-popup/index").then(function(){return resolve(n("4bd1"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/rf-attr-content/index").then(function(){return resolve(n("6ddc"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/rf-rate/rf-rate").then(function(){return resolve(n("a779"))}.bind(null,n)).catch(n.oe)},y=function(){n.e("components/rf-badge/rf-badge").then(function(){return resolve(n("2f68"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/uni-tag/uni-tag").then(function(){return resolve(n("c53c"))}.bind(null,n)).catch(n.oe)},_=function(){n.e("components/rf-nav/index").then(function(){return resolve(n("1d5d"))}.bind(null,n)).catch(n.oe)},C=function(){n.e("components/rf-live/index").then(function(){return resolve(n("6aee"))}.bind(null,n)).catch(n.oe)},k={name:"rfProductDetail",props:{product:{type:Object,default:function(){return{}}},userInfo:{type:Object,default:function(){return{}}},url:{type:String,default:""},marketType:{type:String,default:"buy_now"}},components:{rfNav:_,rfItemPopup:m,rfBadge:y,rfLive:C,rfRate:v,uniTag:b,rfAttrContent:g},data:function(){return{appServiceQr:this.$mSettingConfig.appServiceQr,kefuShow:!1,addressClass:"none",canvasShow:!0,logo:this.$mSettingConfig.appLogo,vipPrice:this.$mAssetsPath.vipPrice,posterShow:!1,serviceClass:"none",ladderPreferentialClass:"none",attributeValueClass:"none",specClass:"none",couponClass:"none",shareClass:"none",fullGiveClass:"none",cartType:null,couponList:[],currentStock:null,currentSkuPrice:null,currentSkuName:null,currentCartCount:1,evaluateList:[],hasLogin:this.$mStore.getters.hasLogin,cartNum:t.getStorageSync("cartNum"),addressTypeList:this.$mConstDataConfig.addressTypeList,tabCurrentIndex:0,loading:!0,errorInfo:"",headImg:this.$mAssetsPath.headImg,isPointExchange:!1,shareBg:this.$mAssetsPath.shareBg,appServiceType:this.$mSettingConfig.appServiceType,productPosterQrType:this.$mSettingConfig.productPosterQrType,appName:this.$mSettingConfig.appName,shareFrom:"",poster:{},promoCode:"",addressList:[],moneySymbol:this.moneySymbol,state:1,singleSkuText:this.singleSkuText,thirdPartyQrCodeImg:""}},onShareAppMessage:function(){var t=this;return h(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post("".concat(a.transmitCreate),{topic_type:"product",topic_id:t.productId}).then((function(){return{title:t.productDetail.name,path:"/pages/product/product?id=".concat(t.productId)}}));case 2:case"end":return e.stop()}}),e)})))()},filters:{time:function(t){return(0,o.default)(1e3*t).format("YYYY-MM-DD HH:mm")},pointExchangeTypeFilter:function(t){var e=["","非积分兑换","积分加现金","积分兑换或直接购买","只支持积分兑换"];return e[parseInt(t,10)]},integralGiveTypeFilter:function(t){var e=["固定积分","百分比"];return e[parseInt(t,10)]},givePointFilter:function(t){return"1"===t.integral_give_type?Math.round(parseInt(t.give_point,10)/100*parseInt(t.minSkuPrice,10)):parseInt(t.give_point,10)}},computed:{type:function(){return"buy_now"},buyBtnDisabled:function(){return 0===parseInt(this.currentStock||this.product.stock,10)},addCartBtnDisabled:function(){return"2"===this.product.point_exchange_type||"4"===this.product.point_exchange_type||0===parseInt(this.currentStock||this.product.stock,10)||"1"===this.product.is_virtual},minNum:function(){return 1},maxNum:function(){var t=0;return t},favorite:function(){return!!this.product.myCollect},second:function(){return function(t){return Math.floor(t-new Date/1e3)}},currentProductPrice:function(){var t;return"buy_now"===this.type?(this.product.memberDiscount&&0!==this.product.memberDiscount.length&&(this.product.minSkuPrice=this.product.minSkuPrice*(1-this.product.memberDiscount.discount/100).toFixed(2),this.product.maxSkuPrice=this.product.maxSkuPrice?(this.product.maxSkuPrice*(1-this.product.memberDiscount.discount/100)).toFixed(2):0),t=this.currentSkuPrice||(this.product.maxSkuPrice&&this.product.minSkuPrice!==this.product.maxSkuPrice?this.product.minSkuPrice+" ~ "+this.product.maxSkuPrice:parseFloat(this.product.minSkuPrice).toFixed(2)),t):parseFloat(t||"0").toFixed(2)}},methods:d(d({},(0,c.mapMutations)(["setCartNum"])),{},{navBack:function(){this.$mRouter.back()},hide:function(){this.kefuShow=!1},share:function(){},navTo:function(t){"1"!==this.appServiceType||"/pages/product/service/index"!==t?this.hasLogin?"0"===this.appServiceType?this.$mHelper.toast("暂不提供客服功能"):this.$mRouter.push({route:t}):this.$mHelper.backToLogin():this.kefuShow=!0},showPopupService:function(t,e){0!==e.length&&(this[t]="show")},hideService:function(){this.specClass="none",this.couponClass="none",this.serviceClass="none",this.ladderPreferentialClass="none",this.attributeValueClass="none",this.fullGiveClass="none"},getCoupon:function(t){var e=this;return h(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.hasLogin){n.next=4;break}return n.next=3,e.$mHelper.backToLogin();case 3:return n.abrupt("return");case 4:return n.next=6,e.$http.post("".concat(u.couponReceive),{id:t.id}).then((function(){e.$mHelper.toast("领取成功")}));case 6:case"end":return n.stop()}}),n)})))()},toEvaluateList:function(){this.product.evaluateStat&&0!==parseInt(this.product.comment_num,10)&&this.$mRouter.push({route:"/pages/order/evaluation/list?comment_num=".concat(this.product.comment_num,"&evaluateStat=").concat(JSON.stringify(this.product.evaluateStat))})},tabClick:function(t,e){this.page=1,this.addressList.length=0,this.tabCurrentIndex=t,this.state=e;var n=1===this.state?u.addressList:a.pickupPointIndex;this.getAddressList(n)},getAddressList:function(t){var e=this;return h(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.get(t,{}).then((function(t){e.addressList=t.data}));case 2:case"end":return n.stop()}}),n)})))()},toggleSpec:function(t){var e=this;if(this.product.id)if("show"===this.specClass){this.currentStock=t.stock,this.currentSkuPrice=t.price,this.currentSkuName=t.skuName,this.currentCartCount=t.cartCount;var n=t.skuId;if(0===parseInt(this.currentStock,10))return void this.$mHelper.toast("库存不足");"cart"===this.cartType?this.handleCartItemCreate(n):"buy"===this.cartType&&this.buy(n),this.cartType=null,this.specClass="hide",setTimeout((function(){e.specClass="none"}),250)}else"none"===this.specClass&&(this.specClass="show")},openPoster:function(){var t=this;return h(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$mHelper.toast("该版本不支持生成海报");case 1:case"end":return e.stop()}}),e)})))()},hideSpec:function(){var t=this;this.specClass="hide",setTimeout((function(){t.specClass="none"}),250)},hideShareSpec:function(){var t=this;this.shareClass="hide",setTimeout((function(){t.shareClass="none"}),250)},handleCartItemCreate:function(t){var e=this;return h(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.post("".concat(i.cartItemCreate),{sku_id:t,num:e.currentCartCount}).then((function(){e.$mHelper.toast("添加购物车成功"),e.$http.get("".concat(i.cartItemCount)).then((function(t){e.setCartNum(t.data),e.cartNum=t.data}))}));case 2:case"end":return n.stop()}}),n)})))()},toFavorite:function(){var t=this;return h(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.product.id){e.next=2;break}return e.abrupt("return");case 2:if(t.hasLogin){e.next=8;break}return t.specClass="none",e.next=6,t.$mHelper.backToLogin();case 6:e.next=9;break;case 8:t.favorite?t.handleCollectDel():t.handleCollectCreate();case 9:case"end":return e.stop()}}),e)})))()},handleCollectCreate:function(){var t=this;return h(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post("".concat(a.collectCreate),{topic_id:t.product.id,topic_type:"product"}).then((function(){t.$mHelper.toast("收藏成功"),t.$emit("product")}));case 2:case"end":return e.stop()}}),e)})))()},handleCollectDel:function(){var t=this;return h(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.delete("".concat(a.collectDel,"?id=").concat(t.product.myCollect.id)).then((function(){t.$mHelper.toast("取消收藏成功"),t.$emit("product")}));case 2:case"end":return e.stop()}}),e)})))()},buy:function(t){var e=this;return h(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o={},o.data=JSON.stringify({sku_id:t,num:e.currentCartCount}),"2"===e.product.point_exchange_type||"4"===e.product.point_exchange_type||"3"===e.product.point_exchange_type&&e.isPointExchange?o.type="point_exchange":o.type=e.type,e.$mRouter.push({route:"/pages/order/create/order?data=".concat(JSON.stringify(o),"&promo_code=").concat(e.promoCode)});case 4:case"end":return n.stop()}}),n)})))()},addCart:function(t,e){this.product.id&&(this.hasLogin?(this.specClass="show",this.cartType=t,this.isPointExchange=e):this.$mHelper.backToLogin())},stopPrevent:function(){}})};e.default=k}).call(this,n("543d")["default"])},cd35:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var r={uniTag:function(){return n.e("components/uni-tag/uni-tag").then(n.bind(null,"c53c"))},rfRate:function(){return n.e("components/rf-rate/rf-rate").then(n.bind(null,"a779"))},rfBadge:function(){return n.e("components/rf-badge/rf-badge").then(n.bind(null,"2f68"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.product.name?parseInt(t.product.is_stock_visible,10):null),r=t.product.name&&1==n?parseInt(t.currentStock,10):null,o=t.product.name?t.__map(t.product.canReceiveCoupon,(function(e,n){var r=t.__get_orig(e),o=parseInt(e.range_type,10),i=t._f("time")(e.start_time),a=t._f("time")(e.end_time),u=parseInt(e.range_type,10),c=parseInt(e.max_fetch,10);return{$orig:r,m2:o,f0:i,f1:a,m3:u,m4:c}})):null,i=t.product.name?parseInt(t.product.max_buy,10):null,a=t.product.name&&"1"!==t.product.point_exchange_type&&t.product.point_exchange_type?t._f("pointExchangeTypeFilter")(t.product.point_exchange_type):null,u=t.product.name&&"1"!==t.product.point_exchange_type?parseInt(t.product.give_point,10):null,c=t.product.name&&"1"!==t.product.point_exchange_type&&u>0?t._f("integralGiveTypeFilter")(t.product.integral_give_type):null,s=t.product.name&&"1"!==t.product.point_exchange_type?parseInt(t.product.give_point,10):null,p=t.product.name&&"1"!==t.product.point_exchange_type&&s>0?t._f("givePointFilter")(t.product):null,d=t.product.name&&t.product.ladderPreferential.length>0?parseInt(t.product.ladderPreferential&&t.product.ladderPreferential[0]&&t.product.ladderPreferential[0].type,10):null,l=t.product.name&&t.product.ladderPreferential.length>0?parseInt(t.product.ladderPreferential&&t.product.ladderPreferential[0]&&t.product.ladderPreferential[0].type,10):null,f=t.product.name&&t.product.ladderPreferential.length>0&&2===l?parseInt(t.product.ladderPreferential&&t.product.ladderPreferential[0]&&t.product.ladderPreferential[0].price,10):null,h=t.product.name&&t.product.ladderPreferential.length>0?t.__map(t.product.ladderPreferential,(function(e,n){var r=t.__get_orig(e),o=parseInt(e.type,10),i=parseInt(e.type,10),a=2===i?parseInt(e.price,10):null;return{$orig:r,m11:o,m12:i,m13:a}})):null,m=t.product.name&&t.product.evaluate&&t.product.evaluate.length>0?t._f("time")(t.product.evaluate&&t.product.evaluate[0]&&t.product.evaluate[0].created_at):null,g=t.product.name?parseInt(this.currentStock||this.product.stock,10):null,v=t.product.name?parseInt(this.currentStock||this.product.stock,10):null;t._isMounted||(t.e0=function(e){t.kefuShow=!0}),t.$mp.data=Object.assign({},{$root:{m0:n,m1:r,l0:o,m5:i,f2:a,m6:u,f3:c,m7:s,f4:p,m8:d,m9:l,m10:f,l1:h,f5:m,m14:g,m15:v}})},i=[]},de18:function(t,e,n){"use strict";var r=n("0da6"),o=n.n(r);o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/rf-product-detail/index-create-component',
    {
        'components/rf-product-detail/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("4c5a"))
        })
    },
    [['components/rf-product-detail/index-create-component']]
]);
