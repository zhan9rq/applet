(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/category"],{"3d3e":function(t,e,n){"use strict";(function(t){n("3029"),n("921b");r(n("66fd"));var e=r(n("caf0"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"59b1":function(t,e,n){"use strict";n.r(e);var r=n("7da8"),a=n.n(r);for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);e["default"]=a.a},"6ade":function(t,e,n){"use strict";var r;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return r}));var a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},"7da8":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n("a34a")),a=n("72a0"),o=n("dc85"),c=n("2f62");function i(t){return t&&t.__esModule?t:{default:t}}function s(t){return h(t)||l(t)||d(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t,e){if(t){if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function l(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function h(t){if(Array.isArray(t))return f(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e,n,r,a,o,c){try{var i=t[o](c),s=i.value}catch(u){return void n(u)}i.done?e(s):Promise.resolve(s).then(r,a)}function g(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function c(t){p(o,r,a,c,i,"next",t)}function i(t){p(o,r,a,c,i,"throw",t)}c(void 0)}))}}function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(){Promise.all([n.e("common/vendor"),n.e("components/rf-search-bar/index")]).then(function(){return resolve(n("3bdc"))}.bind(null,n)).catch(n.oe)},C=function(){n.e("components/rf-attr-content/index").then(function(){return resolve(n("6ddc"))}.bind(null,n)).catch(n.oe)},b={components:{rfSearchBar:w,rfAttrContent:C},data:function(){return{hotSearchDefault:"请输入关键字",showCategoryIndex:0,categoryList:[],specClass:"none",productDetail:{},search:{},cateTop:{},loading:!0,styleCateType:this.$mSettingConfig.styleCateType,errorImage:this.$mAssetsPath.errorImage,currentCateId:"",categoryProductList:[],price:"",total_sales:"",loadingType:"more",page:1,moneySymbol:this.moneySymbol,productLoading:!0,currentSecondCategoryList:[],categoryInvertedIndex:0}},computed:{bottom:function(){var t=0;return t}},filters:{filterTotalSales:function(t){return t>1e4&&(t="".concat((t/1e4).toFixed(2),"w")),t}},onLoad:function(){this.initData()},methods:m(m({moveHandle:function(){}},(0,c.mapMutations)(["setCartNum"])),{},{handleCategoryInvertedChange:function(t,e){this.categoryInvertedIndex=e,this.currentCateId=t.id,this.price="",this.total_sales="",this.page=1,this.categoryProductList=[],this.getProductList()},stopPrevent:function(){},toggleSpec:function(t){var e=this;if(0!==parseInt(t.status,10))if("show"===this.specClass){if(this.specClass="hide",0===t.stock)return void this.$mHelper.toast("库存不足");if("1"===t.type.toString())this.handleCartItemCreate(t.skuId,t.cartCount);else if("2"===t.type.toString()){var n={},r={};r.sku_id=t.skuId,r.num=t.cartCount,"2"===this.productDetail.point_exchange_type.toString()||"4"===this.productDetail.point_exchange_type.toString()||"3"===this.productDetail.point_exchange_type.toString()&&this.isPointExchange?n.type="point_exchange":n.type="buy_now",n.data=JSON.stringify(r),this.navTo("/pages/order/create/order?data=".concat(JSON.stringify(n)))}setTimeout((function(){e.specClass="none"}),250)}else"none"===this.specClass&&this.getProductDetail(t)},handleCartItemCreate:function(t,e){var n=this;return g(r.default.mark((function o(){return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,n.$http.post("".concat(a.cartItemCreate),{sku_id:t,num:e}).then(g(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$http.get("".concat(a.cartItemCount)).then(function(){var t=g(r.default.mark((function t(e){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.setCartNum(e.data);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:n.$mHelper.toast("添加成功，在购物车等");case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return o.stop()}}),o)})))()},hideSpec:function(){var t=this;this.specClass="hide",setTimeout((function(){t.specClass="none"}),250)},getProductDetail:function(t){var e=this;return g(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.get("".concat(a.productDetail),{id:t.id}).then(function(){var t=g(r.default.mark((function t(n){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.productDetail=n.data,e.specClass="show";case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return n.stop()}}),n)})))()},navTo:function(t){this.$mRouter.push({route:t})},initData:function(){var e=this;return g(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.search=t.getStorageSync("search")||{},e.hotSearchDefault=e.search.hot_search_default||"请输入关键字",e.categoryList=[],e.categoryProductList=[],n.next=6,e.getProductCate();case 6:return n.next=8,e.initCartItemCount();case 8:case"end":return n.stop()}}),n)})))()},initCartItemCount:function(){var e=this;return g(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$mStore.getters.hasLogin&&parseInt(t.getStorageSync("cartNum"),10)>0?t.setTabBarBadge({index:e.$mConstDataConfig.cartIndex,text:t.getStorageSync("cartNum").toString()}):(t.removeStorageSync("cartNum"),t.removeTabBarBadge({index:e.$mConstDataConfig.cartIndex}));case 1:case"end":return n.stop()}}),n)})))()},getProductCate:function(e){var n=this;return g(r.default.mark((function o(){return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,n.$http.get("".concat(a.productCate)).then(function(){var a=g(r.default.mark((function a(o){var c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"refresh"===e&&t.stopPullDownRefresh(),r.next=3,n.getAdvList();case 3:return n.categoryList=o.data,c=t.getStorageSync("indexToCateId"),c?n.categoryList.forEach((function(t,e){c===t.id&&(n.showCategoryIndex=e)})):"one_two_product"===n.styleCateType&&o.data[0].child.length>0?n.currentCateId=o.data[0].child[0].id:(n.showCategoryIndex=0,n.currentCateId=n.categoryList&&n.categoryList[0].id),o.data.length>0&&(n.currentSecondCategoryList=o.data[0].child),n.page=1,n.categoryProductList=[],r.next=11,n.getProductList();case 11:n.loading=!1;case 12:case"end":return r.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()).catch((function(){"refresh"===e&&t.stopPullDownRefresh(),n.loading=!1}));case 2:case"end":return o.stop()}}),o)})))()},getAdvList:function(){var t=this;return g(r.default.mark((function e(){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("".concat(o.advList),{location:"cate_top"}).then((function(e){t.cateTop=e.data.cate_top[0]}));case 2:case"end":return e.stop()}}),e)})))()},showCategory:function(t){this.showCategoryIndex=t},showProduct:function(t,e){this.categoryInvertedIndex=0,this.currentSecondCategoryList=t.child,this.showCategoryIndex=e,"one_two_product"===this.styleCateType&&t.child.length>0?this.currentCateId=t.child[0].id:this.currentCateId=t.id,this.price="",this.total_sales="",this.page=1,this.categoryProductList=[],this.getProductList()},handleSalesOrderByChange:function(){0!==this.categoryProductList.length&&(this.price="",this.total_sales="asc"===this.total_sales?"desc":"asc",this.page=1,this.categoryProductList=[],this.getProductList())},handlePriceOrderByChange:function(){0!==this.categoryProductList.length&&(this.total_sales="",this.price="asc"===this.price?"desc":"asc",this.page=1,this.categoryProductList=[],this.getProductList())},getProductList:function(){var e=this;return g(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.productLoading=!0,o={},e.total_sales&&(o.total_sales=e.total_sales),e.price&&(o.price=e.price),o.page=e.page,n.next=7,e.$http.get("".concat(a.productList),m({cate_id:e.currentCateId},o)).then(function(){var n=g(r.default.mark((function n(a){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.productLoading=!1,e.loadingType=10===a.data.length?"more":"nomore",e.categoryProductList=[].concat(s(e.categoryProductList),s(a.data)),t.removeStorageSync("indexToCateId");case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}());case 7:case"end":return n.stop()}}),n)})))()},toSearch:function(){this.$mRouter.push({route:"/pages/index/search/search?data=".concat(JSON.stringify(this.search))})},indexTopToDetailPage:function(t){this.$mHelper.handleBannerNavTo(t.jump_type,t.jump_link,t.id)},getMoreProductList:function(){"nomore"!==this.loadingType&&0!==this.categoryProductList.length&&(this.page++,this.getProductList())}})};e.default=b}).call(this,n("543d")["default"])},9568:function(t,e,n){"use strict";var r=n("c0c7"),a=n.n(r);a.a},c0c7:function(t,e,n){},caf0:function(t,e,n){"use strict";n.r(e);var r=n("6ade"),a=n("59b1");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("9568");var c,i=n("f0c5"),s=Object(i["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],c);e["default"]=s.exports}},[["3d3e","common/runtime","common/vendor"]]]);