(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/detail"],{1521:function(e,t,n){},1702:function(e,t,n){"use strict";n.r(t);var r=n("9e63"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},7093:function(e,t,n){"use strict";var r=n("1521"),i=n.n(r);i.a},"8e73":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var r={uniTag:function(){return n.e("components/uni-tag/uni-tag").then(n.bind(null,"c53c"))},rfImage:function(){return Promise.all([n.e("common/vendor"),n.e("components/rf-image/rf-image")]).then(n.bind(null,"0e89"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.orderDetail.product?e._f("orderStatusFilter")(e.orderDetail.order_status):null),r=e.orderDetail.product?e.__map(e.orderDetail.product,(function(t,n){var r=e.__get_orig(t),i=e._f("filterProductStatus")(t);return{$orig:r,f1:i}})):null,i=e.orderDetail.product?e._f("filterShippingType")(e.orderDetail.shipping_type):null,o=e.orderDetail.product?e._f("keepTwoDecimal")(e.orderDetail.product_original_money||e.orderDetail.product_money):null,a=e.orderDetail.product&&e.orderDetail.invoice?parseInt(e.orderDetail.invoice&&e.orderDetail.invoice.type,10):null,u=e.orderDetail.product?e.__map(e.orderTimeLine,(function(t,n){var r=e.__get_orig(t),i=e._f("time")(t.time);return{$orig:r,f4:i}})):null;e.$mp.data=Object.assign({},{$root:{f0:n,l0:r,f2:i,f3:o,m0:a,l1:u}})},o=[]},"929a":function(e,t,n){"use strict";(function(e){n("3029"),n("921b");r(n("66fd"));var t=r(n("b106"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"9e63":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n("a34a")),i=s(n("9e6c")),o=s(n("595d")),a=n("72a0"),u=n("6f0d"),c=n("dc85");function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,i,o,a){try{var u=e[o](a),c=u.value}catch(s){return void n(s)}u.done?t(c):Promise.resolve(c).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){d(o,r,i,a,u,"next",e)}function u(e){d(o,r,i,a,u,"throw",e)}a(void 0)}))}}var f=function(){Promise.all([n.e("common/vendor"),n.e("components/rf-no-data/index")]).then(function(){return resolve(n("97c0"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/uni-tag/uni-tag").then(function(){return resolve(n("c53c"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/rf-kefu/index").then(function(){return resolve(n("eaa9"))}.bind(null,n)).catch(n.oe)},v={components:{uniTag:p,rfKefu:h,rfNoData:f},data:function(){return{maskState:0,orderDetail:{pickup:{}},logo:this.$mSettingConfig.appLogo,appName:this.$mSettingConfig.appName,invoiceItem:{},loading:!0,errInfo:null,order_id:null,moneySymbol:this.moneySymbol,orderInvoiceContent:"",singleSkuText:this.singleSkuText}},computed:{orderTimeLine:function(){var e=[];return"0"!==this.orderDetail.created_at&&e.push({time:this.orderDetail.created_at,value:"订单创建"}),this.orderDetail.close_time<((new Date).getTime()/1e3&&"0"!==this.orderDetail.pay_time)&&e.push({time:this.orderDetail.close_time,value:"未付款订单关闭时间"}),"0"!==this.orderDetail.pay_time&&e.push({time:this.orderDetail.pay_time,value:"订单支付"}),"0"!==this.orderDetail.shipping_time&&e.push({time:this.orderDetail.shipping_time,value:"买家要求发货"}),"0"!==this.orderDetail.consign_time&&e.push({time:this.orderDetail.consign_time,value:"卖家发货"}),"0"!==this.orderDetail.sign_time&&e.push({time:this.orderDetail.sign_time,value:"买家确认收货"}),"0"!==this.orderDetail.finish_time&&e.push({time:this.orderDetail.finish_time,value:"订单完成"}),e.reverse()}},filters:{time:function(e){return(0,i.default)(1e3*e).format("YYYY-MM-DD HH:mm:ss")},orderStatusFilter:function(e){var t=null;return o.default.orderStatus.forEach((function(n){n.key===parseInt(e,10)&&(t=n.value)})),t},filterProductStatus:function(e){var t=null;return 0!==parseInt(e.refund_status,10)&&-1!==parseInt(e.refund_status,10)&&-2!==parseInt(e.refund_status,10)?o.default.refundStatus.forEach((function(n){n.key===parseInt(e.refund_status,10)&&(t=n.value)})):4===parseInt(e.order_status,10)?o.default.evaluateStatus.forEach((function(n){n.key===parseInt(e.is_evaluate,10)&&(t=n.value)})):(o.default.orderStatus.forEach((function(n){n.key===parseInt(e.order_status,10)&&(t=n.value)})),"1"===e.order_status&&"1"===e.shipping_status&&(t="已发货")),t},filterShippingType:function(e){var t=["","物流配送","买家自提","本地配送"];return t[parseInt(e,10)]}},onLoad:function(e){this.order_id=e.id},onShow:function(){this.initData()},methods:{handleInvoiceContentChange:function(e){this.orderInvoiceContent=e.detail.value},toggleMask:function(e){var t=this,n="show"===e?10:300,r="show"===e?1:0;this.maskState=2,setTimeout((function(){t.maskState=r}),n)},stopPrevent:function(){},copy:function(t){e.setClipboardData({data:t,success:function(){this.$mHelper.toast("复制成功")}})},navTo:function(e){this.$mRouter.push({route:e})},navToEvaluation:function(e,t){this.$mRouter.push({route:"/pages/order/evaluation/evaluation?data=".concat(JSON.stringify(e),"&type=").concat(t)})},navToRefund:function(e,t){this.$mRouter.push({route:"/pages/order/refund/refund?data=".concat(JSON.stringify(e),"&refundType=").concat(t)})},navToShippingReturn:function(e){this.$mRouter.push({route:"/pages/order/shipping/return?data=".concat(JSON.stringify(e))})},handleOrderOperation:function(e,t){switch(t){case"detail":this.navTo("/pages/order/detail?id=".concat(e.id));break;case"evaluation":this.navTo("/pages/order/evaluation/evaluation?order_id=".concat(e.id));break;case"close":this.handleOrderClose(e.id);break;case"delete":this.handleOrderDelete(e.id);break;case"shipping":this.navTo("/pages/order/shipping/shipping?id=".concat(e.id));break;case"delivery":this.handleOrderTakeDelivery(e.id);break}},initData:function(){this.getOrderDetail()},getOrderDetail:function(){var e=this;return l(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("".concat(u.orderDetail),{id:e.order_id}).then((function(t){e.loading=!1,e.orderDetail=t.data,e.invoiceItem.id&&!e.orderDetail.invoice&&e.$http.get(c.configList,{field:"order_invoice_content"}).then((function(t){t.data.order_invoice_content?(e.invoiceItem.invoiceContentArr=t.data.order_invoice_content.split(","),e.orderInvoiceContent=e.invoiceItem.invoiceContentArr[0],e.toggleMask("show")):(e.invoiceItem.invoiceContentArr=[],e.$mHelper.toast("请联系管理员配置发票类型"))}))})).catch((function(t){e.loading=!1,e.errInfo=t}));case 2:case"end":return t.stop()}}),t)})))()},handleOrderInvoiceCreate:function(){var e=this;return l(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post(u.orderInvoiceCreate,{order_id:e.orderDetail.id,invoice_id:e.invoiceItem.id,invoice_content:e.orderInvoiceContent}).then((function(){e.toggleMask(),e.getOrderDetail()}));case 2:case"end":return t.stop()}}),t)})))()},handleOrderClose:function(e){var t=this;return l(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("".concat(a.orderClose),{id:e}).then((function(){t.$mHelper.toast("订单取消成功"),t.getOrderDetail()}));case 2:case"end":return n.stop()}}),n)})))()},handleOrderDelete:function(e){var t=this;return l(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.delete("".concat(u.orderDelete,"?id=").concat(e),{}).then((function(){t.$mHelper.toast("订单删除成功"),t.$mRouter.back()}));case 2:case"end":return n.stop()}}),n)})))()},handleOrderTakeDelivery:function(e){var t=this;return l(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("".concat(u.orderTakeDelivery),{id:e}).then((function(){t.$mHelper.toast("确认收货成功"),t.getOrderDetail()}));case 2:case"end":return n.stop()}}),n)})))()},handleCloseOrderRefundApply:function(t,n){var i=this;return l(r.default.mark((function o(){return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.showModal({content:"取消退款后将无法再次提交申请，是否继续取消退款?",success:function(){var e=l(r.default.mark((function e(o){var a;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!o.confirm){e.next=5;break}return a=u.closeOrderRefundApply,4===parseInt(t,10)&&(a=u.orderCustomerRefundClose),e.next=5,i.$http.post("".concat(a),{id:n}).then((function(e){i.$mHelper.toast("取消成功"),i.getOrderDetail()}));case 5:case"end":return e.stop()}}),e)})));function o(t){return e.apply(this,arguments)}return o}()});case 1:case"end":return o.stop()}}),o)})))()}}};t.default=v}).call(this,n("543d")["default"])},b106:function(e,t,n){"use strict";n.r(t);var r=n("8e73"),i=n("1702");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("7093");var a,u=n("f0c5"),c=Object(u["a"])(i["default"],r["b"],r["c"],!1,null,"5a7439ee",null,!1,r["a"],a);t["default"]=c.exports}},[["929a","common/runtime","common/vendor"]]]);