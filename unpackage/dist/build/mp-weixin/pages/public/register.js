(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/register"],{"65d6":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(r("a34a")),n=r("2f62"),a=r("f15c"),s=i(r("9e6c"));function i(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r,o,n,a,s){try{var i=e[a](s),c=i.value}catch(u){return void r(u)}i.done?t(c):Promise.resolve(c).then(o,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var a=e.apply(t,r);function s(e){c(a,o,n,s,i,"next",e)}function i(e){c(a,o,n,s,i,"throw",e)}s(void 0)}))}}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f={data:function(){return{appAgreementDefaultSelect:this.$mSettingConfig.appAgreementDefaultSelect,closeRegisterPromoCode:this.$mSettingConfig.closeRegisterPromoCode,registerParams:{mobile:"",password:"",password_repetition:"",promoCode:"",nickname:"",code:""},btnLoading:!1,reqBody:{},codeSeconds:0,smsCodeBtnDisabled:!0}},onShow:function(){e.getStorageSync("accessToken")&&this.$mRouter.reLaunch({route:"/pages/index/index"})},onLoad:function(t){this.$mStore.getters.hasLogin&&this.$mRouter.reLaunch({route:"/pages/index/index"});var r=(0,s.default)().valueOf()/1e3-e.getStorageSync("registerSmsCodeTime");r<60?(this.codeSeconds=this.$mConstDataConfig.sendCodeTime-parseInt(r,10),this.handleSmsCodeTime(this.codeSeconds)):(this.codeSeconds=this.$mConstDataConfig.sendCodeTime,this.smsCodeBtnDisabled=!1,e.removeStorageSync("registerSmsCodeTime"));var o=e.getStorageSync("backToPage");-1!==o.indexOf("promo_code")?this.registerParams.promoCode=JSON.parse(o)["query"]["promo_code"]:this.registerParams.promoCode=t.promo_code},methods:l(l({isAppAgreementDefaultSelect:function(){this.appAgreementDefaultSelect=!this.appAgreementDefaultSelect}},(0,n.mapMutations)(["login"])),{},{navBack:function(){this.$mRouter.back()},navTo:function(e){this.$mRouter.push({route:e})},getSmsCode:function(){var t=this;this.reqBody["mobile"]=this.registerParams["mobile"];var r=this.$mGraceChecker.check(this.reqBody,this.$mFormRule.sendCodeRule);r?this.$http.post(a.smsCode,{mobile:this.registerParams.mobile,usage:"register"}).then((function(r){r.data?t.$mHelper.toast("验证码发送成功, 验证码是".concat(r.data)):t.$mHelper.toast("验证码已发送."),t.smsCodeBtnDisabled=!0,e.setStorageSync("registerSmsCodeTime",(0,s.default)().valueOf()/1e3),t.handleSmsCodeTime(59)})):this.$mHelper.toast(this.$mGraceChecker.error)},handleSmsCodeTime:function(e){var t=this,r=setInterval((function(){0===e?(clearInterval(r),t.smsCodeBtnDisabled=!1):(t.codeSeconds=e,t.smsCodeBtnDisabled=!0,e--)}),1e3)},toRegister:function(){var t=this;return u(o.default.mark((function r(){var n;return o.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.$mSettingConfig.closeRegister){r.next=3;break}return t.$mHelper.toast("暂未开放注册，敬请期待～"),r.abrupt("return");case 3:if(t.appAgreementDefaultSelect){r.next=6;break}return t.$mHelper.toast("请勾选同意注册协议，即可注册哦"),r.abrupt("return");case 6:if(t.reqBody["mobile"]=t.registerParams["mobile"],t.reqBody["password"]=t.registerParams["password"],t.reqBody["code"]=t.registerParams["code"],t.reqBody["nickname"]=t.registerParams["nickname"],n=t.$mGraceChecker.check(t.reqBody,t.$mFormRule.registerRule),n){r.next=14;break}return t.$mHelper.toast(t.$mGraceChecker.error),r.abrupt("return");case 14:if(t.registerParams["password"]===t.registerParams["password_repetition"]){r.next=17;break}return t.$mHelper.toast("两次输入的密码不一致"),r.abrupt("return");case 17:return t.reqBody["password_repetition"]=t.registerParams["password_repetition"],t.reqBody["promo_code"]=t.registerParams["promoCode"],t.btnLoading=!0,t.reqBody.group=t.$mHelper.platformGroupFilter(),r.next=23,t.$http.post(a.registerByPass,t.reqBody).then((function(){t.btnLoading=!1,t.$mHelper.toast("恭喜您注册成功"),e.setStorageSync("loginMobile",t.reqBody["mobile"]),e.setStorageSync("loginPassword",t.reqBody["password"]),t.$mRouter.push({route:"/pages/public/login"})})).catch((function(){t.btnLoading=!1}));case 23:case"end":return r.stop()}}),r)})))()}})};t.default=f}).call(this,r("543d")["default"])},"69e6":function(e,t,r){"use strict";r.r(t);var o=r("b42a"),n=r("9621");for(var a in n)"default"!==a&&function(e){r.d(t,e,(function(){return n[e]}))}(a);r("7479");var s,i=r("f0c5"),c=Object(i["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);t["default"]=c.exports},7479:function(e,t,r){"use strict";var o=r("e668"),n=r.n(o);n.a},9621:function(e,t,r){"use strict";r.r(t);var o=r("65d6"),n=r.n(o);for(var a in o)"default"!==a&&function(e){r.d(t,e,(function(){return o[e]}))}(a);t["default"]=n.a},b42a:function(e,t,r){"use strict";var o;r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o}));var n=function(){var e=this,t=e.$createElement;e._self._c},a=[]},b8f1:function(e,t,r){"use strict";(function(e){r("3029"),r("921b");o(r("66fd"));var t=o(r("69e6"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},e668:function(e,t,r){}},[["b8f1","common/runtime","common/vendor"]]]);